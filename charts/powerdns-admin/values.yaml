image:
  # -- image repository
  repository: app.image
  # -- image tag
  # @default -- chart.appVersion
  tag: app.image.tag
  # -- image pull policy
  pullPolicy: IfNotPresent

# -- environment variables. See [undocumented configs](https://github.com/PowerDNS-Admin/PowerDNS-Admin/blob/master/configs/docker_config.py)
# and [application docs](# https://github.com/PowerDNS-Admin/PowerDNS-Admin/blob/master/configs/development.py) for more details.
# @default -- See below (only deviations from the default settings are specified)
env:
  # Application Configuration
  # -- Application Timezone
  TZ: UTC
  # -- Unique app Key
  SECRET_KEY: changeme
  # -- Database connection string - if not set uses internal sqlite db
  # SQLALCHEMY_DATABASE_URI: mysql://db_user:db_pass@db_host/powerdns_admin
  # Additional Gunicorn settings (as environment variables)
  GUNICORN_TIMEOUT: 60
  GUNICORN_WORKERS: 4
  GUNICORN_LOGLEVEL: DEBUG

# -- Configures service settings for the chart.
service:
  main:
    type: LoadBalancer
    ports:
      http:
        port: 80

# -- Probe configuration to fix connection instability
probes:
  liveness:
    spec:
      # Increased timeout from 1 to 10 seconds
      timeoutSeconds: 10
      # Increased failure threshold from 3 to 5
      failureThreshold: 5
      # Increased initial delay
      initialDelaySeconds: 30
  readiness:
    spec:
      # Increased timeout from 1 to 10 seconds
      timeoutSeconds: 10
      # Increased failure threshold from 3 to 5
      failureThreshold: 5
      # Increased initial delay
      initialDelaySeconds: 30
  startup:
    spec:
      # Increased timeout from 1 to 10 seconds
      timeoutSeconds: 10
      # Increased failure threshold from 30 to 60
      failureThreshold: 60
      # Increased period seconds for startup check
      periodSeconds: 10

ingress:
  # -- Enable and configure ingress settings for the chart under this key.
  main:
    enabled: false

# -- Configure persistence settings for the chart under this key.
# this persists the internal sqlite DB if no other database is enabled
persistence:
  data:
    enabled: false

# -- Set the resource requests / limits for the main container.
resources:
  limits:
    cpu: 1000m
    memory: 1Gi
  requests:
    cpu: 500m
    memory: 512Mi