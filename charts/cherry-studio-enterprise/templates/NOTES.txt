ğŸ‰ Cherry Studio Enterprise éƒ¨ç½²æˆåŠŸï¼

================================================================================
ğŸ“‹ æœåŠ¡è®¿é—®ä¿¡æ¯
================================================================================

ğŸŒ API æœåŠ¡ (Ingress):

{{- if .Values.app.api.ingress.enabled }}
{{- range $host := .Values.app.api.ingress.hosts }}
  {{- range .paths }}
http{{ if $.Values.app.api.ingress.tls }}s{{ end }}://{{ $host.host }}{{ .path }}
  {{- end }}
{{- end }}
{{- else if contains "NodePort" .Values.app.api.service.type }}
ğŸ”— API æœåŠ¡ (NodePort):
   ğŸ“ æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è·å–è®¿é—®åœ°å€ï¼š
   export NODE_PORT=$(kubectl get --namespace {{ .Release.Namespace }} -o jsonpath="{.spec.ports[0].nodePort}" services {{ include "cherry-studio-enterprise.fullname" . }}-api)
   export NODE_IP=$(kubectl get nodes --namespace {{ .Release.Namespace }} -o jsonpath="{.items[0].status.addresses[0].address}")
   echo "ğŸŒ API: http://$NODE_IP:$NODE_PORT"
{{- else if contains "LoadBalancer" .Values.app.api.service.type }}
ğŸ”— API æœåŠ¡ (LoadBalancer):
   âš ï¸  æ³¨æ„ï¼šå¯èƒ½éœ€è¦å‡ åˆ†é’Ÿæ—¶é—´æ‰èƒ½è·å¾— LoadBalancer çš„ IP åœ°å€
   ğŸ“ ç›‘æ§æœåŠ¡çŠ¶æ€ï¼š
   kubectl get --namespace {{ .Release.Namespace }} svc -w {{ include "cherry-studio-enterprise.fullname" . }}-api

   ğŸ“ è·å–è®¿é—®åœ°å€ï¼š
   export SERVICE_IP=$(kubectl get svc --namespace {{ .Release.Namespace }} {{ include "cherry-studio-enterprise.fullname" . }}-api --template "{{"{{ range (index .status.loadBalancer.ingress 0) }}{{.}}{{ end }}"}}")
   echo "ğŸŒ API: http://$SERVICE_IP:{{ .Values.app.api.service.port }}"
{{- else if contains "ClusterIP" .Values.app.api.service.type }}
ğŸ”— API æœåŠ¡ (ClusterIP):
   ğŸ“ æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿›è¡Œç«¯å£è½¬å‘ï¼š
   export POD_NAME=$(kubectl get pods --namespace {{ .Release.Namespace }} -l "app.kubernetes.io/name={{ include "cherry-studio-enterprise.name" . }},app.kubernetes.io/component=api" -o jsonpath="{.items[0].metadata.name}")
   export CONTAINER_PORT=$(kubectl get pod --namespace {{ .Release.Namespace }} $POD_NAME -o jsonpath="{.spec.containers[0].ports[0].containerPort}")
   echo "ğŸŒ API è®¿é—®: http://127.0.0.1:{{ .Values.app.api.service.port }}"
   kubectl --namespace {{ .Release.Namespace }} port-forward $POD_NAME {{ .Values.app.api.service.port }}:$CONTAINER_PORT
{{- end }}

ğŸ–¥ï¸  Admin æœåŠ¡ (Ingress):

{{- if .Values.app.admin.ingress.enabled }}
{{- range $host := .Values.app.admin.ingress.hosts }}
  {{- range .paths }}
http{{ if $.Values.app.admin.ingress.tls }}s{{ end }}://{{ $host.host }}{{ .path }}
  {{- end }}
{{- end }}
{{- else if contains "NodePort" .Values.app.admin.service.type }}
ğŸ”— Admin æœåŠ¡ (NodePort):
   ğŸ“ æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è·å–è®¿é—®åœ°å€ï¼š
   export ADMIN_NODE_PORT=$(kubectl get --namespace {{ .Release.Namespace }} -o jsonpath="{.spec.ports[0].nodePort}" services {{ include "cherry-studio-enterprise.fullname" . }}-admin)
   export NODE_IP=$(kubectl get nodes --namespace {{ .Release.Namespace }} -o jsonpath="{.items[0].status.addresses[0].address}")
   echo "ğŸ–¥ï¸  Admin: http://$NODE_IP:$ADMIN_NODE_PORT"
{{- else if contains "LoadBalancer" .Values.app.admin.service.type }}
ğŸ”— Admin æœåŠ¡ (LoadBalancer):
   âš ï¸  æ³¨æ„ï¼šå¯èƒ½éœ€è¦å‡ åˆ†é’Ÿæ—¶é—´æ‰èƒ½è·å¾— LoadBalancer çš„ IP åœ°å€
   ğŸ“ è·å–è®¿é—®åœ°å€ï¼š
   export ADMIN_SERVICE_IP=$(kubectl get svc --namespace {{ .Release.Namespace }} {{ include "cherry-studio-enterprise.fullname" . }}-admin --template "{{"{{ range (index .status.loadBalancer.ingress 0) }}{{.}}{{ end }}"}}")
   echo "ğŸ–¥ï¸  Admin: http://$ADMIN_SERVICE_IP:{{ .Values.admin.service.port }}"
{{- else if contains "ClusterIP" .Values.app.admin.service.type }}
ğŸ”— Admin æœåŠ¡ (ClusterIP):
   ğŸ“ æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿›è¡Œç«¯å£è½¬å‘ï¼š
   export ADMIN_POD_NAME=$(kubectl get pods --namespace {{ .Release.Namespace }} -l "app.kubernetes.io/name={{ include "cherry-studio-enterprise.name" . }},app.kubernetes.io/component=admin" -o jsonpath="{.items[0].metadata.name}")
   export ADMIN_CONTAINER_PORT=$(kubectl get pod --namespace {{ .Release.Namespace }} $ADMIN_POD_NAME -o jsonpath="{.spec.containers[0].ports[0].containerPort}")
   echo "ğŸ–¥ï¸  Admin è®¿é—®: http://127.0.0.1:{{ .Values.admin.service.port }}"
   kubectl --namespace {{ .Release.Namespace }} port-forward $ADMIN_POD_NAME {{ .Values.admin.service.port }}:$ADMIN_CONTAINER_PORT
{{- end }}

================================================================================
ğŸ“š é‡è¦è¯´æ˜
================================================================================

ğŸ’¡ æ¶æ„è¯´æ˜ï¼š
   â€¢ API æœåŠ¡ï¼šåç«¯ API æœåŠ¡ï¼Œé»˜è®¤ä½¿ç”¨ SQLite æ•°æ®åº“
   â€¢ Admin æœåŠ¡ï¼šå‰ç«¯ç®¡ç†ç•Œé¢ï¼Œæä¾› Web UI

âš ï¸  æ³¨æ„äº‹é¡¹ï¼š
   â€¢ API æœåŠ¡å¦‚æœä½¿ç”¨ SQLite æ•°æ®åº“ï¼ŒPod æ•°é‡è¦æ±‚ä¸º 1
   â€¢ API æ•°æ®å­˜å‚¨åœ¨æŒä¹…åŒ–å·ä¸­ï¼ˆ/app/dataï¼‰
   â€¢ Admin æœåŠ¡é»˜è®¤ä¸å¯ç”¨æŒä¹…åŒ–å­˜å‚¨

ğŸ”§ ç®¡ç†å‘½ä»¤ï¼š
   â€¢ æŸ¥çœ‹æœåŠ¡çŠ¶æ€ï¼škubectl get pods,svc,ingress -n {{ .Release.Namespace }}
   â€¢ æŸ¥çœ‹æ—¥å¿—ï¼škubectl logs -f deployment/{{ include "cherry-studio-enterprise.fullname" . }}-api -n {{ .Release.Namespace }}
   â€¢ å¤‡ä»½æ•°æ®ï¼šå¤‡ä»½ PVC {{ include "cherry-studio-enterprise.fullname" . }}-data

================================================================================
